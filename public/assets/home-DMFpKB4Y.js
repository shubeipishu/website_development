import"./modulepreload-polyfill-B5Qt9EMX.js";import{i as y,a as v,t as r,_ as w,g as d,o as q}from"./i18n-n2hhxkI7.js";async function f(t="zh"){if(document.getElementById("changelog-list"))try{let a=await fetch(t==="en"?"/data/changelog.en.json":"/data/changelog.json");if(!a.ok&&t==="en"&&(a=await fetch("/data/changelog.json")),!a.ok)return;const o=await a.json();L(o)}catch{console.log("Changelog data not available, using static content")}}function L(t){const n=document.getElementById("changelog-list");!n||!t.length||(n.innerHTML=t.slice(0,5).map(e=>`
        <div class="changelog-item">
            <span class="changelog-date">${e.date}</span>
            <div class="changelog-content">
                <div class="changelog-title">${e.title}</div>
                <div class="changelog-desc">${e.description||""}</div>
            </div>
        </div>
    `).join(""))}function h(){document.querySelectorAll(".faq-question").forEach(t=>{t.addEventListener("click",()=>{const n=t.closest(".faq-item");if(!n)return;const e=n.classList.contains("active");document.querySelectorAll(".faq-item.active").forEach(a=>{a.classList.remove("active")}),e||n.classList.add("active")})})}async function u(t="zh"){if(document.getElementById("faq-list"))try{let a=await fetch(t==="en"?"/data/faq.en.json":"/data/faq.json");if(!a.ok&&t==="en"&&(a=await fetch("/data/faq.json")),!a.ok)return;const o=await a.json();b(o)}catch{console.log("FAQ data not available, using static content")}}function b(t){const n=document.getElementById("faq-list");!n||!t.length||(n.innerHTML=t.map(e=>`
        <div class="faq-item">
            <button class="faq-question">
                <span>${e.question}</span>
                <span class="faq-icon">+</span>
            </button>
            <div class="faq-answer">
                <div class="faq-answer-inner">${e.answer}</div>
            </div>
        </div>
    `).join(""),h())}function E(){const t=document.getElementById("feedback-form");t&&t.addEventListener("submit",async n=>{n.preventDefault();const e=t.querySelector('button[type="submit"]');if(!e)return;const a=document.getElementById("form-message"),o=e.textContent??"";e.disabled=!0,e.textContent=r("feedback.submitting");try{const c=new FormData(t),p={email:c.get("email"),message:c.get("message"),timestamp:new Date().toISOString()};if((await fetch("/api/feedback",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(p)})).ok)g(a,r("feedback.success"),"success"),t.reset();else throw new Error("提交失败")}catch{g(a,r("feedback.error"),"error")}finally{e.disabled=!1,e.textContent=o}})}function g(t,n,e){t&&(t.textContent=n,t.className=`form-message ${e}`,setTimeout(()=>{t.className="form-message"},5e3))}async function k(){try{await fetch("/api/stats/visit",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({page:window.location.pathname,referrer:document.referrer||null,timestamp:new Date().toISOString()})})}catch{}}async function C(){const t=document.getElementById("visit-count");if(t)try{const n=await fetch("/api/stats/count");if(!n.ok)return;const e=await n.json();typeof e.count=="number"&&(t.textContent=e.count.toLocaleString("zh-CN"))}catch{}}let l=!1,i=!1,s=null;function S(){if(!document.getElementById("particle-canvas")||l||i)return;const n=async()=>{if(!(l||i)){i=!0;try{const a=await w(()=>import("./effects-D-uKM2he.js"),[]);s=a,a.initEffects(d()),l=!0}catch(a){console.warn("Failed to load effects module:",a),i=!1}}},e=window;e.requestIdleCallback?(e.requestIdleCallback(n,{timeout:1500}),setTimeout(n,2e3)):setTimeout(n,600),window.addEventListener("load",n,{once:!0})}function I(){document.querySelectorAll('a[href^="#"]').forEach(t=>{t.addEventListener("click",function(n){n.preventDefault();const e=document.querySelector(this.getAttribute("href")||"");e&&e.scrollIntoView({behavior:"smooth",block:"start"})})})}const m=()=>{y(),v(),h(),E(),f(d()),u(d()),k(),C(),S(),I(),q(t=>{f(t),u(t),s!=null&&s.updateTypewriterLanguage&&s.updateTypewriterLanguage(t)})};document.readyState==="loading"?document.addEventListener("DOMContentLoaded",m):m();
