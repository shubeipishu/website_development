import"./modulepreload-polyfill-B5Qt9EMX.js";import{i as S,a as C,t as m,g as h,o as I}from"./i18n-CTpBxxhn.js";const T="modulepreload",j=function(e){return"/"+e},y={},A=function(n,t,a){let i=Promise.resolve();if(t&&t.length>0){document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),s=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));i=Promise.allSettled(t.map(r=>{if(r=j(r),r in y)return;y[r]=!0;const f=r.endsWith(".css"),b=f?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${r}"]${b}`))return;const c=document.createElement("link");if(c.rel=f?"stylesheet":T,f||(c.as="script"),c.crossOrigin="",c.href=r,s&&c.setAttribute("nonce",s),document.head.appendChild(c),f)return new Promise((q,k)=>{c.addEventListener("load",q),c.addEventListener("error",()=>k(new Error(`Unable to preload CSS for ${r}`)))})}))}function l(o){const s=new Event("vite:preloadError",{cancelable:!0});if(s.payload=o,window.dispatchEvent(s),!s.defaultPrevented)throw o}return i.then(o=>{for(const s of o||[])s.status==="rejected"&&l(s.reason);return n().catch(l)})};async function p(e="zh"){if(document.getElementById("changelog-list"))try{let a=await fetch(e==="en"?"/data/changelog.en.json":"/data/changelog.json");if(!a.ok&&e==="en"&&(a=await fetch("/data/changelog.json")),!a.ok)return;const i=await a.json();B(i)}catch{console.log("Changelog data not available, using static content")}}function B(e){const n=document.getElementById("changelog-list");!n||!e.length||(n.innerHTML=e.slice(0,5).map(t=>`
        <div class="changelog-item">
            <span class="changelog-date">${t.date}</span>
            <div class="changelog-content">
                <div class="changelog-title">${t.title}</div>
                <div class="changelog-desc">${t.description||""}</div>
            </div>
        </div>
    `).join(""))}function L(){document.querySelectorAll(".faq-question").forEach(e=>{e.addEventListener("click",()=>{const n=e.closest(".faq-item");if(!n)return;const t=n.classList.contains("active");document.querySelectorAll(".faq-item.active").forEach(a=>{a.classList.remove("active")}),t||n.classList.add("active")})})}async function v(e="zh"){if(document.getElementById("faq-list"))try{let a=await fetch(e==="en"?"/data/faq.en.json":"/data/faq.json");if(!a.ok&&e==="en"&&(a=await fetch("/data/faq.json")),!a.ok)return;const i=await a.json();D(i)}catch{console.log("FAQ data not available, using static content")}}function D(e){const n=document.getElementById("faq-list");!n||!e.length||(n.innerHTML=e.map(t=>`
        <div class="faq-item">
            <button class="faq-question">
                <span>${t.question}</span>
                <span class="faq-icon">+</span>
            </button>
            <div class="faq-answer">
                <div class="faq-answer-inner">${t.answer}</div>
            </div>
        </div>
    `).join(""),L())}function F(){const e=document.getElementById("feedback-form");e&&e.addEventListener("submit",async n=>{n.preventDefault();const t=e.querySelector('button[type="submit"]');if(!t)return;const a=document.getElementById("form-message"),i=t.textContent??"";t.disabled=!0,t.textContent=m("feedback.submitting");try{const l=new FormData(e),o={email:l.get("email"),message:l.get("message"),timestamp:new Date().toISOString()};if((await fetch("/api/feedback",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(o)})).ok)w(a,m("feedback.success"),"success"),e.reset();else throw new Error("提交失败")}catch{w(a,m("feedback.error"),"error")}finally{t.disabled=!1,t.textContent=i}})}function w(e,n,t){e&&(e.textContent=n,e.className=`form-message ${t}`,setTimeout(()=>{e.className="form-message"},5e3))}async function O(){try{await fetch("/api/stats/visit",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({page:window.location.pathname,referrer:document.referrer||null,timestamp:new Date().toISOString()})})}catch{}}async function P(){const e=document.getElementById("visit-count");if(e)try{const n=await fetch("/api/stats/count");if(!n.ok)return;const t=await n.json();typeof t.count=="number"&&(e.textContent=t.count.toLocaleString("zh-CN"))}catch{}}let g=!1,u=!1,d=null;function $(){if(!document.getElementById("particle-canvas")||g||u)return;const n=async()=>{if(!(g||u)){u=!0;try{const a=await A(()=>import("./effects-D-uKM2he.js"),[]);d=a,a.initEffects(h()),g=!0}catch(a){console.warn("Failed to load effects module:",a),u=!1}}},t=window;t.requestIdleCallback?(t.requestIdleCallback(n,{timeout:1500}),setTimeout(n,2e3)):setTimeout(n,600),window.addEventListener("load",n,{once:!0})}function U(){document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(n){n.preventDefault();const t=document.querySelector(this.getAttribute("href")||"");t&&t.scrollIntoView({behavior:"smooth",block:"start"})})})}const E=()=>{S(),C(),L(),F(),p(h()),v(h()),O(),P(),$(),U(),I(e=>{p(e),v(e),d!=null&&d.updateTypewriterLanguage&&d.updateTypewriterLanguage(e)})};document.readyState==="loading"?document.addEventListener("DOMContentLoaded",E):E();
