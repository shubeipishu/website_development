import"./modulepreload-polyfill-B5Qt9EMX.js";import{i as E}from"./theme-DERj3x_X.js";const q="modulepreload",L=function(n){return"/"+n},m={},b=function(t,e,s){let l=Promise.resolve();if(e&&e.length>0){document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),a=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));l=Promise.allSettled(e.map(i=>{if(i=L(i),i in m)return;m[i]=!0;const d=i.endsWith(".css"),y=d?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${i}"]${y}`))return;const r=document.createElement("link");if(r.rel=d?"stylesheet":q,d||(r.as="script"),r.crossOrigin="",r.href=i,a&&r.setAttribute("nonce",a),document.head.appendChild(r),d)return new Promise((p,w)=>{r.addEventListener("load",p),r.addEventListener("error",()=>w(new Error(`Unable to preload CSS for ${i}`)))})}))}function c(o){const a=new Event("vite:preloadError",{cancelable:!0});if(a.payload=o,window.dispatchEvent(a),!a.defaultPrevented)throw o}return l.then(o=>{for(const a of o||[])a.status==="rejected"&&c(a.reason);return t().catch(c)})};async function S(){if(document.getElementById("changelog-list"))try{const t=await fetch("/data/changelog.json");if(!t.ok)return;const e=await t.json();C(e)}catch{console.log("Changelog data not available, using static content")}}function C(n){const t=document.getElementById("changelog-list");!t||!n.length||(t.innerHTML=n.slice(0,5).map(e=>`
        <div class="changelog-item">
            <span class="changelog-date">${e.date}</span>
            <div class="changelog-content">
                <div class="changelog-title">${e.title}</div>
                <div class="changelog-desc">${e.description||""}</div>
            </div>
        </div>
    `).join(""))}function v(){document.querySelectorAll(".faq-question").forEach(n=>{n.addEventListener("click",()=>{const t=n.closest(".faq-item");if(!t)return;const e=t.classList.contains("active");document.querySelectorAll(".faq-item.active").forEach(s=>{s.classList.remove("active")}),e||t.classList.add("active")})})}async function k(){if(document.getElementById("faq-list"))try{const t=await fetch("/data/faq.json");if(!t.ok)return;const e=await t.json();I(e)}catch{console.log("FAQ data not available, using static content")}}function I(n){const t=document.getElementById("faq-list");!t||!n.length||(t.innerHTML=n.map(e=>`
        <div class="faq-item">
            <button class="faq-question">
                <span>${e.question}</span>
                <span class="faq-icon">+</span>
            </button>
            <div class="faq-answer">
                <div class="faq-answer-inner">${e.answer}</div>
            </div>
        </div>
    `).join(""),v())}function A(){const n=document.getElementById("feedback-form");n&&n.addEventListener("submit",async t=>{t.preventDefault();const e=n.querySelector('button[type="submit"]');if(!e)return;const s=document.getElementById("form-message"),l=e.textContent??"";e.disabled=!0,e.textContent="提交中...";try{const c=new FormData(n),o={email:c.get("email"),message:c.get("message"),timestamp:new Date().toISOString()};if((await fetch("/api/feedback",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(o)})).ok)g(s,"感谢您的反馈！我们会尽快回复。","success"),n.reset();else throw new Error("提交失败")}catch{g(s,"提交失败，请稍后重试。","error")}finally{e.disabled=!1,e.textContent=l}})}function g(n,t,e){n&&(n.textContent=t,n.className=`form-message ${e}`,setTimeout(()=>{n.className="form-message"},5e3))}async function T(){try{await fetch("/api/stats/visit",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({page:window.location.pathname,referrer:document.referrer||null,timestamp:new Date().toISOString()})})}catch{}}async function j(){const n=document.getElementById("visit-count");if(n)try{const t=await fetch("/api/stats/count");if(!t.ok)return;const e=await t.json();typeof e.count=="number"&&(n.textContent=e.count.toLocaleString("zh-CN"))}catch{}}let f=!1,u=!1;function B(){if(!document.getElementById("particle-canvas")||f||u)return;const t=async()=>{if(!(f||u)){u=!0;try{(await b(()=>import("./effects-GgcxkiV0.js"),[])).initEffects(),f=!0}catch(s){console.warn("Failed to load effects module:",s),u=!1}}},e=window;e.requestIdleCallback?(e.requestIdleCallback(t,{timeout:1500}),setTimeout(t,2e3)):setTimeout(t,600),window.addEventListener("load",t,{once:!0})}function D(){document.querySelectorAll('a[href^="#"]').forEach(n=>{n.addEventListener("click",function(t){t.preventDefault();const e=document.querySelector(this.getAttribute("href")||"");e&&e.scrollIntoView({behavior:"smooth",block:"start"})})})}const h=()=>{E(),v(),A(),S(),k(),T(),j(),B(),D()};document.readyState==="loading"?document.addEventListener("DOMContentLoaded",h):h();
